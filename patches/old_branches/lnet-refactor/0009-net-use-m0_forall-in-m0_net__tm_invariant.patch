From e528f32a01d0e988eaa01416bd39a6eda353b810 Mon Sep 17 00:00:00 2001
From: "Valery V. Vorotyntsev" <valery_vorotyntsev@xyratex.com>
Date: Sat, 13 Jul 2013 00:07:47 +0300
Subject: [PATCH 09/14] net: use m0_forall() in m0_net__tm_invariant()

---
 net/tm.c | 9 +++------
 1 file changed, 3 insertions(+), 6 deletions(-)

diff --git a/net/tm.c b/net/tm.c
index f8c57dd..e8df08f 100644
--- a/net/tm.c
+++ b/net/tm.c
@@ -78,12 +78,9 @@ M0_INTERNAL bool m0_net__tm_invariant(const struct m0_net_transfer_mc *tm)
 	    tm->ntm_ep == NULL)
 		return false;
 	if (tm->ntm_state != M0_NET_TM_STARTED &&
-	    tm->ntm_state != M0_NET_TM_STOPPING) {
-		int i;
-		for (i = 0; i < ARRAY_SIZE(tm->ntm_q); ++i)
-			if (!m0_net_tm_tlist_is_empty(&tm->ntm_q[i]))
-				return false;
-	}
+	    tm->ntm_state != M0_NET_TM_STOPPING)
+		m0_forall(i, ARRAY_SIZE(tm->ntm_q),
+			  m0_net_tm_tlist_is_empty(&tm->ntm_q[i]));
 	return true;
 }
 
-- 
1.8.3.2

