From 76b2c3f1bdfbfdd8761dafcf4819d2c243516667 Mon Sep 17 00:00:00 2001
From: "Valery V. Vorotyntsev" <valery_vorotyntsev@xyratex.com>
Date: Mon, 15 Jul 2013 23:47:48 +0300
Subject: [PATCH 14/14] lnet: minor code cleanup

---
 net/lnet/bev_cqueue.c               | 5 +++--
 net/lnet/linux_kernel/kbev_cqueue.c | 4 ++--
 2 files changed, 5 insertions(+), 4 deletions(-)

diff --git a/net/lnet/bev_cqueue.c b/net/lnet/bev_cqueue.c
index 8abd27f..d94b3c8 100644
--- a/net/lnet/bev_cqueue.c
+++ b/net/lnet/bev_cqueue.c
@@ -725,11 +725,12 @@ static struct nlx_core_bev_link *bev_cqueue_get(struct nlx_core_bev_cqueue *q)
 
 	if (bev_cqueue_is_empty(q)) /* also checks invariant */
 		return NULL;
+
 	link = (struct nlx_core_bev_link *) q->cbcq_consumer;
 	M0_ASSERT(link->cbl_c_next != 0);
-	q->cbcq_consumer = (nlx_core_opaque_ptr_t) link->cbl_c_next;
+	q->cbcq_consumer = link->cbl_c_next;
 	m0_atomic64_dec(&q->cbcq_count);
-	return (struct nlx_core_bev_link *) (q->cbcq_consumer);
+	return (struct nlx_core_bev_link *) q->cbcq_consumer;
 }
 
 /**
diff --git a/net/lnet/linux_kernel/kbev_cqueue.c b/net/lnet/linux_kernel/kbev_cqueue.c
index 0fead4d..4d89b20 100644
--- a/net/lnet/linux_kernel/kbev_cqueue.c
+++ b/net/lnet/linux_kernel/kbev_cqueue.c
@@ -33,8 +33,8 @@
    @pre bev_cqueue_invariant(q)
    @post p->cbl_c_self != q->cbcq_consumer
  */
-static struct nlx_core_bev_link *bev_cqueue_pnext(
-					   const struct nlx_core_bev_cqueue *q)
+static struct nlx_core_bev_link *
+bev_cqueue_pnext(const struct nlx_core_bev_cqueue *q)
 {
 	struct nlx_core_bev_link *p;
 	const struct nlx_core_kmem_loc *loc;
-- 
1.8.3.2

