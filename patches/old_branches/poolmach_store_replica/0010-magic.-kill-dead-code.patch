From 864cee979b618fe39e53980ac0f17b233dca79fd Mon Sep 17 00:00:00 2001
From: Hua Huang <hua_huang@xyratex.com>
Date: Tue, 7 May 2013 19:53:37 +0800
Subject: [PATCH 10/14] magic. kill dead code.

---
 mero/magic.h      |  8 ++++----
 pool/Makefile.sub |  3 +--
 pool/pool.c       |  2 +-
 pool/pool_fops.h  | 56 -------------------------------------------------------
 rpc/service.h     |  6 ------
 5 files changed, 6 insertions(+), 69 deletions(-)
 delete mode 100644 pool/pool_fops.h

diff --git a/mero/magic.h b/mero/magic.h
index 6b9f7a9..6d82f02 100644
--- a/mero/magic.h
+++ b/mero/magic.h
@@ -532,11 +532,11 @@ enum m0_magic_satchel {
 	M0_NET_TEST_TIMESTAMP_MAGIC = 0x33a111edcab1a177,
 
 /* Pool Machine */
-	/* m0_pool_event_link::pel_magic (poolli)*/
-	M0_POOL_EVENTS_LIST_MAGIC = 0x33706f6f6c6c6977,
+	/* m0_pool_event_link::pel_magic (pool evnt list)*/
+	M0_POOL_EVENTS_LIST_MAGIC = 0x3360013747712777,
 
-	/* poolmach_tl::tl_head_magic (poolhe)*/
-	M0_POOL_EVENTS_HEAD_MAGIC = 0x33706f6f6c686577,
+	/* poolmach_tl::tl_head_magic (pool evnt head)*/
+	M0_POOL_EVENTS_HEAD_MAGIC = 0x33600137474ead77,
 
 
 /* Request handler */
diff --git a/pool/Makefile.sub b/pool/Makefile.sub
index 9c1d53a..63ff458 100644
--- a/pool/Makefile.sub
+++ b/pool/Makefile.sub
@@ -1,5 +1,4 @@
-nobase_mero_include_HEADERS += pool/pool.h \
-			       pool/pool_fops.h
+nobase_mero_include_HEADERS += pool/pool.h
 
 mero_libmero_la_SOURCES  += pool/pool.c \
 			    pool/pool_store.c
diff --git a/pool/pool.c b/pool/pool.c
index 2f21ec6..a49a9e1 100644
--- a/pool/pool.c
+++ b/pool/pool.c
@@ -488,7 +488,7 @@ M0_INTERNAL int m0_poolmach_state_transit(struct m0_poolmach *pm,
 						     (M0_PNDS_SNS_REBALANCED)));
 				spare_array[i].psu_device_index =
 						POOL_PM_SPARE_SLOT_UNUSED;
-			break;
+				break;
 			}
 		}
 		break;
diff --git a/pool/pool_fops.h b/pool/pool_fops.h
deleted file mode 100644
index 9cb92e7..0000000
--- a/pool/pool_fops.h
+++ /dev/null
@@ -1,56 +0,0 @@
-/* -*- C -*- */
-/*
- * COPYRIGHT 2013 XYRATEX TECHNOLOGY LIMITED
- *
- * THIS DRAWING/DOCUMENT, ITS SPECIFICATIONS, AND THE DATA CONTAINED
- * HEREIN, ARE THE EXCLUSIVE PROPERTY OF XYRATEX TECHNOLOGY
- * LIMITED, ISSUED IN STRICT CONFIDENCE AND SHALL NOT, WITHOUT
- * THE PRIOR WRITTEN PERMISSION OF XYRATEX TECHNOLOGY LIMITED,
- * BE REPRODUCED, COPIED, OR DISCLOSED TO A THIRD PARTY, OR
- * USED FOR ANY PURPOSE WHATSOEVER, OR STORED IN A RETRIEVAL SYSTEM
- * EXCEPT AS ALLOWED BY THE TERMS OF XYRATEX LICENSES AND AGREEMENTS.
- *
- * YOU SHOULD HAVE RECEIVED A COPY OF XYRATEX'S LICENSE ALONG WITH
- * THIS RELEASE. IF NOT PLEASE CONTACT A XYRATEX REPRESENTATIVE
- * http://www.xyratex.com/contact
- *
- * Original author: Huang Hua <Hua_Huang@xyratex.com>
- * Original creation date: 05/03/2013
- */
-
-#pragma once
-
-#ifndef __MERO_POOL_POOL_FOPS_H__
-#define __MERO_POOL_POOL_FOPS_H__
-
-#include "ioservice/io_fops.h"
-#include "ioservice/io_fops_xc.h"
-
-struct m0_poolmach_update_fop_req {
-	/** replica's cached version. */
-        struct m0_fv_version pu_fv_version;
-} M0_XCA_RECORD;
-
-struct m0_poolmach_update_fop_rep {
-	uint32_t            pu_rc;
-
-	/** latest version number. */
-        struct m0_fv_version pu_fv_version;
-
-	/** events list */
-        struct m0_fv_updates pu_fv_updates;
-} M0_XCA_RECORD;
-
-
-/* __MERO_POOL_POOL_FOPS_H__ */
-#endif
-
-/*
- *  Local variables:
- *  c-indentation-style: "K&R"
- *  c-basic-offset: 8
- *  tab-width: 8
- *  fill-column: 80
- *  scroll-step: 1
- *  End:
- */
diff --git a/rpc/service.h b/rpc/service.h
index 21da369..ada58b8 100644
--- a/rpc/service.h
+++ b/rpc/service.h
@@ -48,12 +48,6 @@ struct m0_rpc_service_ops;
 M0_INTERNAL int m0_rpc_service_module_init(void);
 M0_INTERNAL void m0_rpc_service_module_fini(void);
 
-/** @todo XXX This is stub definition
-struct m0_uuid {
-	char u_uuid[40];
-};
-*/
-
 struct m0_rpc_service_type {
 	/** Numeric id that uniquely identifies a service type */
 	uint32_t                              svt_type_id;
-- 
1.8.3.2

