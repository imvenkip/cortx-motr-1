From 0743beae589e94e390d06a447eca9bbf921dd8d6 Mon Sep 17 00:00:00 2001
From: Maxim Medved <Max_Medved@xyratex.com>
Date: Wed, 21 Aug 2013 14:29:37 +0300
Subject: [PATCH 19/34] be/ut/helper: m0_be_ut_seg::bus_dtx removed

---
 be/ut/helper.c | 4 +---
 be/ut/helper.h | 1 -
 2 files changed, 1 insertion(+), 4 deletions(-)

diff --git a/be/ut/helper.c b/be/ut/helper.c
index e949102..569ede9 100644
--- a/be/ut/helper.c
+++ b/be/ut/helper.c
@@ -382,9 +382,8 @@ static void be_ut_seg_init(struct m0_be_ut_seg *ut_seg,
 	}
 	M0_CNT_INC(h->buh_storage_ref_cnt);
 
-	m0_dtx_init(&ut_seg->bus_dtx);
 	if (stob_create) {
-		rc = m0_stob_create_helper(h->buh_stob_dom, &ut_seg->bus_dtx,
+		rc = m0_stob_create_helper(h->buh_stob_dom, NULL,
 					   &stob_id, &ut_seg->bus_stob);
 		M0_ASSERT(rc == 0);
 	} else {
@@ -415,7 +414,6 @@ static void be_ut_seg_fini(struct m0_be_ut_seg *ut_seg, bool stob_destroy)
 	m0_mutex_lock(&h->buh_lock);
 	if (stob_destroy)
 		m0_stob_put(ut_seg->bus_stob);
-	m0_dtx_fini(&ut_seg->bus_dtx);
 
 	M0_CNT_DEC(h->buh_storage_ref_cnt);
 	if (h->buh_storage_ref_cnt == 0) {
diff --git a/be/ut/helper.h b/be/ut/helper.h
index 44e229c..8190f47 100644
--- a/be/ut/helper.h
+++ b/be/ut/helper.h
@@ -60,7 +60,6 @@ void m0_be_ut_backend_thread_exit(struct m0_be_ut_backend *ut_be);
 void m0_be_ut_tx_init(struct m0_be_tx *tx, struct m0_be_ut_backend *ut_be);
 
 struct m0_be_ut_seg {
-	struct m0_dtx            bus_dtx;
 	/**
 	 * Stob to test. It can point to m0_be_ut_seg.bus_stob_ if
 	 * there is new stob and to existing stob if it isn't new.
-- 
1.8.3.2

