From 90ebde5117be0c8336ff44091453f420e9cb4d92 Mon Sep 17 00:00:00 2001
From: Maxim Medved <max_medved@xyratex.com>
Date: Fri, 13 Dec 2013 01:18:35 +0200
Subject: [PATCH 28/96] be/ut/helper: ut_seg can be NULL in M0_BE_UT_TRANSACT()

---
 be/ut/helper.h | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

diff --git a/be/ut/helper.h b/be/ut/helper.h
index 9135bc0..09fd7bb 100644
--- a/be/ut/helper.h
+++ b/be/ut/helper.h
@@ -186,11 +186,12 @@ M0_INTERNAL int m0_be_ut__seg_dict_destroy(struct m0_be_seg   *seg,
  * If __ut_seg set to non-NULL value then
  * m0_be_ut_txc will be used to check capturing.
  */
-#define M0_BE_UT_TRANSACT(__ut_be, __ut_seg,				\
+#define M0_BE_UT_TRANSACT(__ut_be, __ut_seg_,				\
 			  __tx, __cred, __credit_func, __action_func)	\
 	do {								\
-		struct m0_be_tx_credit	__cred = {};			\
-		struct m0_be_ut_txc	__tc   = {};			\
+		struct m0_be_tx_credit	__cred	 = {};			\
+		struct m0_be_ut_seg    *__ut_seg = (__ut_seg_);		\
+		struct m0_be_ut_txc	__tc	 = {};			\
 		struct m0_be_tx	       *__tx;				\
 		int			__rc;				\
 									\
-- 
1.8.3.2

