From 6eea018af7a438a588a3586090921e5bfd35c08e Mon Sep 17 00:00:00 2001
From: Maxim Medved <max_medved@xyratex.com>
Date: Tue, 14 Jan 2014 18:25:21 +0200
Subject: [PATCH 51/96] be/fl: index_round_*() simplified

---
 be/fl.c | 12 ++++--------
 1 file changed, 4 insertions(+), 8 deletions(-)

diff --git a/be/fl.c b/be/fl.c
index 9d81f70..0d10aab 100644
--- a/be/fl.c
+++ b/be/fl.c
@@ -108,19 +108,15 @@ M0_INTERNAL void m0_be_fl_destroy(struct m0_be_fl *fl, struct m0_be_tx *tx)
 M0_INTERNAL unsigned long m0_be_fl_index_round_up(struct m0_be_fl *fl,
 						  m0_bcount_t size)
 {
-	unsigned long index;
-
-	index = m0_align(size, M0_BE_FL_STEP) / M0_BE_FL_STEP;
-	return index > M0_BE_FL_NR ? M0_BE_FL_NR : index;
+	return min_type(unsigned long, M0_BE_FL_NR,
+			m0_align(size, M0_BE_FL_STEP) / M0_BE_FL_STEP);
 }
 
 M0_INTERNAL unsigned long m0_be_fl_index_round_down_chunk(struct m0_be_fl *fl,
 						  struct be_alloc_chunk *chunk)
 {
-	unsigned long index;
-
-	index = chunk->bac_size / M0_BE_FL_STEP;
-	return index > M0_BE_FL_NR ? M0_BE_FL_NR : index;
+	return min_type(unsigned long, M0_BE_FL_NR,
+			chunk->bac_size / M0_BE_FL_STEP);
 }
 
 M0_INTERNAL bool m0_be_fl__invariant(struct m0_be_fl *fl)
-- 
1.8.3.2

