From 2122deeb484cc625ca4c6666701e6c21feb93273 Mon Sep 17 00:00:00 2001
From: Alexander Gattin <alexander_gattin@xyratex.com>
Date: Wed, 13 Feb 2013 21:13:07 +0200
Subject: [PATCH 66/99] net-test/demo: use the next order: consoles, clients,
 servers

---
 net/test/demo/demo.exp | 16 ++++++++--------
 1 file changed, 8 insertions(+), 8 deletions(-)

diff --git a/net/test/demo/demo.exp b/net/test/demo/demo.exp
index 9a434b8..328d346 100755
--- a/net/test/demo/demo.exp
+++ b/net/test/demo/demo.exp
@@ -64,11 +64,11 @@ proc init_host {addr {tmout 10}} {
 # 4. nid_al - NID
 # 5. cep_al - command EP - NID:LNETPID:PORTAL:TMID0
 # 6. dep_al - data EP - NID:LNETPID:PORTAL:TMID1
-proc init_hosts {shosts chosts consoles ntopts_al} {
+proc init_hosts {consoles chosts shosts ntopts_al} {
     array set ntopts $ntopts_al
     # create list of unique addresses:
     set hosts ""
-    foreach h [concat $shosts $chosts $consoles] {
+    foreach h [concat $consoles $chosts $shosts] {
         if {! [info exists u($h)]} {
             set u($h) 1
             lappend hosts $h
@@ -111,8 +111,8 @@ proc init_hosts {shosts chosts consoles ntopts_al} {
     }
     # assign pair of endpoints to each server, client and console:
     set tmid $ntopts(e)  ;# counter
-    array set role {consoles con shosts srv chosts clnt}
-    foreach l {shosts chosts consoles} {
+    array set role {consoles con chosts clnt shosts srv}
+    foreach l {consoles chosts shosts} {
         set r $role($l)
         foreach h [set $l] {  ;# contents of the list named by $l
             if {[info exists nid($h)]} {
@@ -147,7 +147,7 @@ proc main {argv0 argv} {
         {v                  "turn on verbose mode"}
         {w.arg    10        "ssh and commands' timeout"}
     }
-    set usg "\[options\] srv1\[,srv2...\] clnt1\[,clnt2...\]"
+    set usg "\[options\] clnt1\[,clnt2...\] srv1\[,...\] \[con1...\]"
     if {[catch {
         array set ntopts [::cmdline::getoptions argv $optdesc $usg]
         if {[llength $argv] < 2 || [llength $argv] > 3} {
@@ -156,11 +156,11 @@ proc main {argv0 argv} {
         send_error "USAGE: $err"
         exit 1
     }
-    set shosts [split [lindex $argv 0] ,]
-    set chosts [split [lindex $argv 1] ,]
+    set chosts [split [lindex $argv 0] ,]
+    set shosts [split [lindex $argv 1] ,]
     if {[llength $argv] == 3} {set console [lindex $argv 2]} {
         set console localhost}
-    set r [init_hosts $shosts $chosts [list $console] [array get ntopts]]
+    set r [init_hosts [list $console] $chosts $shosts [array get ntopts]]
     array set cep [lindex $r 5]
     array set dep [lindex $r 6]
     send_user "\n"
-- 
1.8.3.2

