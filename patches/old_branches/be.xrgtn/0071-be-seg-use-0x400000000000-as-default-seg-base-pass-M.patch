From f28486db1d070b4cb0d67aac04398bf58c84e404 Mon Sep 17 00:00:00 2001
From: Alexander Gattin <alexander_gattin@xyratex.com>
Date: Thu, 30 May 2013 19:00:20 +0300
Subject: [PATCH 071/228] be/seg: use 0x400000000000 as default seg base, pass
 MAP_PRIVATE to mmap

---
 be/seg.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/be/seg.c b/be/seg.c
index 0694d58..b3772f5 100644
--- a/be/seg.c
+++ b/be/seg.c
@@ -34,7 +34,7 @@
  * @{
  */
 
-#define BE_SEG_DEFAULT_ADDR   ((void *)0x0708000000000000)
+#define BE_SEG_DEFAULT_ADDR   ((void *)0x400000000000)
 #define BE_SEG_HEADER_OFFSET  (0ULL)
 
 /* "On-disk" header for segment, stored in STOB at zero offset */
@@ -242,7 +242,7 @@ M0_INTERNAL int m0_be_seg_open(struct m0_be_seg *seg)
 #ifndef __KERNEL__
 	/* mmap an area at bh_addr of bh_size. */
 	p = mmap(seg_addr0, seg_size, PROT_READ|PROT_WRITE,
-		 MAP_FIXED|MAP_ANONYMOUS, -1, 0);
+		 MAP_FIXED|MAP_ANONYMOUS|MAP_PRIVATE, -1, 0);
 	if (p == MAP_FAILED)
 		return -errno;
 	M0_ASSERT(p == seg_addr0);
-- 
1.8.3.2

