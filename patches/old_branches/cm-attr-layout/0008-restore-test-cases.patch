From c83e1798c5f8153a9b1e804039a3b6cd1810fb9b Mon Sep 17 00:00:00 2001
From: Hua Huang <hua_huang@xyratex.com>
Date: Wed, 3 Apr 2013 10:46:57 +0800
Subject: [PATCH 08/18] restore test cases

---
 extra-libs/galois                           |  2 +-
 m0t1fs/linux_kernel/st/m0t1fs_client_inc.sh | 11 +++++------
 scripts/m0                                  | 10 +++++-----
 3 files changed, 11 insertions(+), 12 deletions(-)

diff --git a/extra-libs/galois b/extra-libs/galois
index 10ccbd0..3230956 160000
--- a/extra-libs/galois
+++ b/extra-libs/galois
@@ -1 +1 @@
-Subproject commit 10ccbd0ca55db92909fda817ee1065d914736440
+Subproject commit 32309568c1977a934d9aab96552392417ca9dd21
diff --git a/m0t1fs/linux_kernel/st/m0t1fs_client_inc.sh b/m0t1fs/linux_kernel/st/m0t1fs_client_inc.sh
index ddc6937..db0ee8f 100644
--- a/m0t1fs/linux_kernel/st/m0t1fs_client_inc.sh
+++ b/m0t1fs/linux_kernel/st/m0t1fs_client_inc.sh
@@ -509,12 +509,6 @@ sns_repair_test()
 
 m0t1fs_system_tests()
 {
-	sns_repair_test || {
-		echo "Failed: SNS repair failed.."
-		return 1
-	}
-	return 0
-
 	file_creation_test $MAX_NR_FILES || {
                 echo "Failed: File creation test failed."
 		return 1
@@ -530,6 +524,11 @@ m0t1fs_system_tests()
 		return 1
 	}
 
+	sns_repair_test || {
+		echo "Failed: SNS repair failed.."
+		return 1
+	}
+
 	m0loop_st || return 1
 
 	return 0
diff --git a/scripts/m0 b/scripts/m0
index 121b1e2..c17c880 100755
--- a/scripts/m0
+++ b/scripts/m0
@@ -57,17 +57,17 @@ run_kut() {
 run_st() {
     _reset
 
-#    $SUDO "$SRC/net/test/st/st.sh"
+    $SUDO "$SRC/net/test/st/st.sh"
 
     ## rpc ping
-#    $SUDO "$SRC/m0t1fs/linux_kernel/st/st" insmod
+    $SUDO "$SRC/m0t1fs/linux_kernel/st/st" insmod
     local rc=0
-#    "$SRC/rpc/it/st" || rc=$?
-#    $SUDO "$SRC/m0t1fs/linux_kernel/st/st" rmmod
+    "$SRC/rpc/it/st" || rc=$?
+    $SUDO "$SRC/m0t1fs/linux_kernel/st/st" rmmod
     [ $rc -eq 0 ] || exit $rc
 
     ## conf ST
-#    $SUDO SANDBOX_DIR=${RUNDIR}/_m0-sandbox "$SRC/m0t1fs/linux_kernel/st/st"
+    $SUDO SANDBOX_DIR=${RUNDIR}/_m0-sandbox "$SRC/m0t1fs/linux_kernel/st/st"
 
     ## other ST
     $SUDO "$SRC/m0t1fs/linux_kernel/st/m0t1fs_test.sh"
-- 
1.8.3.2

