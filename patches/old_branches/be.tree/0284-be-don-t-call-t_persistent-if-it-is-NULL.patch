From 3869df03ae7c8396c4904ec49c73290484f63303 Mon Sep 17 00:00:00 2001
From: "Valery V. Vorotyntsev" <valery_vorotyntsev@xyratex.com>
Date: Fri, 5 Jul 2013 01:13:12 +0300
Subject: [PATCH 284/290] be: don't call ->t_persistent() if it is NULL

---
 be/tx_fom.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/be/tx_fom.c b/be/tx_fom.c
index 5aa33c2..0049ab5 100644
--- a/be/tx_fom.c
+++ b/be/tx_fom.c
@@ -467,8 +467,9 @@ static enum m0_fom_phase_outcome placing_tick(struct m0_fom *fom)
 	m0_be_op_init(op);
 	m0_be_seg_write_simple(seg, op, area);
 
+	if (tx->t_persistent != NULL)
+		tx->t_persistent(tx);
 	m->tgf_tx_to_place = gr_tlist_next(&gr->tg_txs, tx);
-	tx->t_persistent(tx);
 
 	M0_LEAVE();
 	return m0_be_op_tick_ret(op, fom, TGS_PLACING);
-- 
1.8.3.2

