From 8bcfdb256f17748e07178618da121a28a8ec1fd6 Mon Sep 17 00:00:00 2001
From: "Valery V. Vorotyntsev" <valery_vorotyntsev@xyratex.com>
Date: Wed, 4 Jul 2012 23:30:24 +0300
Subject: [PATCH 223/311] c2_rpc_post() might start returning errors in the
 future.

LogD #270
RB: r/865
---
 conf/confc.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/conf/confc.c b/conf/confc.c
index d70f889..ade4d0f 100644
--- a/conf/confc.c
+++ b/conf/confc.c
@@ -652,7 +652,8 @@ static void wait_reply_st_in(struct c2_sm *mach)
 	C2_PRE(request_is_valid(ctx->fc_req));
 
 	rc = c2_rpc_post(&ctx->fc_fop.f_item);
-	C2_ASSERT(rc == 0); /* c2_rpc_post() always returns 0, but hey */
+	if (rc != 0)
+		c2_sm_fail(mach, S_FAILURE, rc);
 }
 
 /** Actions to perform on entering S_GROW_CACHE state. */
-- 
1.8.3.2

