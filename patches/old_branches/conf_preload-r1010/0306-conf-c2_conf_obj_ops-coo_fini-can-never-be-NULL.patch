From 738bf8e8bff1ef6af3006c74833aac742e08c8a4 Mon Sep 17 00:00:00 2001
From: "Valery V. Vorotyntsev" <valery_vorotyntsev@xyratex.com>
Date: Tue, 28 Aug 2012 21:43:45 +0300
Subject: [PATCH 306/311] conf: c2_conf_obj_ops::coo_fini can never be NULL

RB: r/981/diff/3/?file=27985#file27985line523
---
 conf/obj.h | 2 --
 conf/reg.c | 3 +--
 2 files changed, 1 insertion(+), 4 deletions(-)

diff --git a/conf/obj.h b/conf/obj.h
index 2b603ed..7409464 100644
--- a/conf/obj.h
+++ b/conf/obj.h
@@ -514,8 +514,6 @@ struct c2_conf_obj_ops {
 	 * The intended usage of ->coo_fini() is to free the allocated
 	 * concrete object (i.e., the ambient object that `obj' is
 	 * embedded in).
-	 *
-	 * NULL is a noop.
 	 */
 	void (*coo_fini)(struct c2_conf_obj *obj);
 };
diff --git a/conf/reg.c b/conf/reg.c
index 58768bf..4ebc066 100644
--- a/conf/reg.c
+++ b/conf/reg.c
@@ -76,8 +76,7 @@ static void del(struct c2_conf_obj *obj)
 	C2_PRE(obj->co_nrefs == 0 && obj->co_status != C2_CS_LOADING);
 
 	c2_conf_reg_tlist_del(obj);
-	if (obj->co_ops->coo_fini != NULL)
-		obj->co_ops->coo_fini(obj);
+	obj->co_ops->coo_fini(obj);
 }
 
 void c2_conf_reg_delete(const struct c2_conf_reg *reg, struct c2_conf_obj *obj)
-- 
1.8.3.2

