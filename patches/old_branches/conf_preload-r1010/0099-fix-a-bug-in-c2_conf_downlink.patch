From 2627a6249d05bc72cb89eefc0db125fa3899fbae Mon Sep 17 00:00:00 2001
From: "Valery V. Vorotyntsev" <valery_vorotyntsev@xyratex.com>
Date: Thu, 29 Mar 2012 22:56:43 +0300
Subject: [PATCH 099/311] fix a bug in c2_conf_downlink()

---
 conf/path.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/conf/path.c b/conf/path.c
index f7bcd34..0365133 100644
--- a/conf/path.c
+++ b/conf/path.c
@@ -95,7 +95,7 @@ const struct c2_conf_relation * c2_conf_downlink(uint32_t src, uint32_t tgt)
 
 	for (i = 0; i < rs->nr; ++i) {
 		if (rs->data[i]->r_type == tgt)
-			return rs->data[i];
+			return rs->data + i;
 	}
 	return NULL;
 }
@@ -110,7 +110,7 @@ static bool pathcomp_invariant(const struct c2_conf_pathcomp *pc)
 
 bool c2_conf_eop(const struct c2_conf_pathcomp *pc)
 {
-	C2_ASSERT(pathcomp_invariant(pc));
+	C2_PRE(pathcomp_invariant(pc));
 	return pc->pc_iskey == ~0U;
 }
 
-- 
1.8.3.2

