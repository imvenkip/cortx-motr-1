From 6318cb7cb828dc85b705d29868c7f10f758ebf17 Mon Sep 17 00:00:00 2001
From: Maxim Medved <Max_Medved@xyratex.com>
Date: Thu, 24 Jan 2013 12:17:22 +0200
Subject: [PATCH 68/71] added missing net/test/debug.h

---
 net/test/debug.h | 86 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 86 insertions(+)
 create mode 100644 net/test/debug.h

diff --git a/net/test/debug.h b/net/test/debug.h
new file mode 100644
index 0000000..652751e
--- /dev/null
+++ b/net/test/debug.h
@@ -0,0 +1,86 @@
+/* -*- C -*- */
+/*
+ * COPYRIGHT 2012 XYRATEX TECHNOLOGY LIMITED
+ *
+ * THIS DRAWING/DOCUMENT, ITS SPECIFICATIONS, AND THE DATA CONTAINED
+ * HEREIN, ARE THE EXCLUSIVE PROPERTY OF XYRATEX TECHNOLOGY
+ * LIMITED, ISSUED IN STRICT CONFIDENCE AND SHALL NOT, WITHOUT
+ * THE PRIOR WRITTEN PERMISSION OF XYRATEX TECHNOLOGY LIMITED,
+ * BE REPRODUCED, COPIED, OR DISCLOSED TO A THIRD PARTY, OR
+ * USED FOR ANY PURPOSE WHATSOEVER, OR STORED IN A RETRIEVAL SYSTEM
+ * EXCEPT AS ALLOWED BY THE TERMS OF XYRATEX LICENSES AND AGREEMENTS.
+ *
+ * YOU SHOULD HAVE RECEIVED A COPY OF XYRATEX'S LICENSE ALONG WITH
+ * THIS RELEASE. IF NOT PLEASE CONTACT A XYRATEX REPRESENTATIVE
+ * http://www.xyratex.com/contact
+ *
+ * Original author: Maxim Medved <max_medved@xyratex.com>
+ * Original creation date: 01/12/2012
+ */
+
+#pragma once
+
+#ifndef __COLIBRI_NET_TEST_DEBUG_H__
+#define __COLIBRI_NET_TEST_DEBUG_H__
+
+#include "lib/trace.h"	/* C2_LOG */
+
+/**
+   @defgroup NetTestDebugDFS Debugging tools
+   @ingroup NetTestDFS
+
+   Usage recipe
+   0. in .c file
+   1. #ifdef NET_TEST_MODULE_NAME
+      #undef NET_TEST_MODULE_NAME
+      #endif
+   2. #define NET_TEST_MODULE_NAME name_of_net_test_module
+   3. #include "net/test/debug.h"
+   4. Use LOGD() macro for regular debug output.
+   5. Enable/disable debug output from any point using
+      LOGD_VAR_NAME(some_module_name) variable
+      (declared using LOGD_VAR_DECLARE(some_module_name) (disabled by default).
+
+   Macro names used: LOGD, NET_TEST_MODULE_NAME, LOGD_VAR_DECLARE, LOGD_VAR_NAME
+
+   @{
+ */
+
+#ifndef NET_TEST_MODULE_NAME
+C2_BASSERT("NET_TEST_MODULE_NAME should be defined "
+	   "before including debug.h" == NULL);
+#endif
+
+#define LOGD_VAR_NAME(module_name)					\
+	C2_CAT(c2_net_test_logd_, module_name)
+
+bool LOGD_VAR_NAME(NET_TEST_MODULE_NAME) = false;
+
+#define LOGD_VAR_DECLARE(module_name)					\
+	extern bool LOGD_VAR_NAME(module_name);
+
+#ifdef LOGD
+#undef LOGD
+#endif
+#define LOGD(...)							\
+	do {								\
+		if (LOGD_VAR_NAME(NET_TEST_MODULE_NAME))		\
+			C2_LOG(C2_DEBUG, ##__VA_ARGS__);		\
+	} while (0)
+
+
+/**
+   @} end of NetTestDebugDFS group
+ */
+
+#endif /*  __COLIBRI_NET_TEST_DEBUG_H__ */
+
+/*
+ *  Local variables:
+ *  c-indentation-style: "K&R"
+ *  c-basic-offset: 8
+ *  tab-width: 8
+ *  fill-column: 79
+ *  scroll-step: 1
+ *  End:
+ */
-- 
1.8.3.2

