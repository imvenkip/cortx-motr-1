From 0dd739e7061f01910a8ab472dc6b50b6db53b172 Mon Sep 17 00:00:00 2001
From: Maxim Medved <Max_Medved@xyratex.com>
Date: Fri, 30 Nov 2012 22:20:04 +0200
Subject: [PATCH 56/71] LogD 1538: channel will not be signaled when
 c2_net_tm_start() fails

---
 net/test/network.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/net/test/network.c b/net/test/network.c
index 036b7a6..742dd68 100644
--- a/net/test/network.c
+++ b/net/test/network.c
@@ -331,7 +331,8 @@ int c2_net_test_network_ctx_init(struct c2_net_test_network_ctx *ctx,
 	c2_clink_init(&tmwait, NULL);
 	c2_clink_add(&ctx->ntc_tm->ntm_chan, &tmwait);
 	rc = c2_net_tm_start(ctx->ntc_tm, tm_addr);
-	c2_chan_wait(&tmwait);
+	if (rc == 0)
+		c2_chan_wait(&tmwait);
 	c2_clink_del(&tmwait);
 	c2_clink_fini(&tmwait);
 	if (rc != 0)
-- 
1.8.3.2

