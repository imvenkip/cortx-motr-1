From b3e96751f2aba54b8327ba8b1d4175ce2da3dc37 Mon Sep 17 00:00:00 2001
From: "Valery V. Vorotyntsev" <valery_vorotyntsev@xyratex.com>
Date: Thu, 30 Aug 2012 17:47:41 +0300
Subject: [PATCH 344/370] conf: [minor edit] fix alignment and untabify

---
 colibri/Makefile.am |  2 +-
 conf/Makefile.am    |  4 ++--
 conf/obj_ops.c      | 33 +++++++++++++++------------------
 conf/ut/prepar.c    | 10 ++++------
 4 files changed, 22 insertions(+), 27 deletions(-)

diff --git a/colibri/Makefile.am b/colibri/Makefile.am
index 86dfb38..b91f0ef 100644
--- a/colibri/Makefile.am
+++ b/colibri/Makefile.am
@@ -19,7 +19,7 @@ libcolibri_la_LIBADD      = @AIO_LIBS@ @PTHREAD_LIBS@ @DB_LIBS@ @GALOIS_LIBS@ @Y
                             $(top_builddir)/addb/libcolibri-addb.la \
                             $(top_builddir)/addb/addbff/libcolibri-addbff.la \
                             $(top_builddir)/balloc/libcolibri-balloc.la \
-			    $(top_builddir)/capa/libcolibri-capa.la \
+                            $(top_builddir)/capa/libcolibri-capa.la \
                             $(top_builddir)/cfg/libcolibri-cfg.la \
                             $(top_builddir)/cob/libcolibri-cob.la \
                             $(top_builddir)/conf/libcolibri-conf.la \
diff --git a/conf/Makefile.am b/conf/Makefile.am
index 1b8942e..90e1c4e 100644
--- a/conf/Makefile.am
+++ b/conf/Makefile.am
@@ -4,7 +4,7 @@ noinst_LTLIBRARIES = libcolibri-conf.la
 libcolibri_conf_la_SOURCES = obj.h obj.c reg.h reg.c obj_ops.h obj_ops.c \
                              onwire.h preload.h preload.c
 
-INCLUDES	= -iquote . -iquote $(top_srcdir) -iquote \
-		$(top_srcdir)/include -iquote /usr/include
+INCLUDES = -iquote . -iquote $(top_srcdir) -iquote $(top_srcdir)/include \
+           -iquote /usr/include
 
 clean-local: clean-xc
diff --git a/conf/obj_ops.c b/conf/obj_ops.c
index bfd2728..7cd5be9 100644
--- a/conf/obj_ops.c
+++ b/conf/obj_ops.c
@@ -674,11 +674,11 @@ int c2_conf_obj_fill(struct c2_conf_obj *dest, const struct confx_object *src,
 	return 0;
 }
 
-#define DUMMY_FILL(abbrev)					\
-static int abbrev ## _fill(struct c2_conf_obj *__dest,			\
-		    const struct confx_object *__src,		\
-		    struct c2_conf_reg *reg)			\
-{								\
+#define DUMMY_FILL(abbrev)                                              \
+static int abbrev ## _fill(struct c2_conf_obj *__dest,                  \
+			   const struct confx_object *__src,            \
+			   struct c2_conf_reg *reg)                     \
+{                                                                       \
 	C2_IMPOSSIBLE("c2_conf_dir is never filled from confx_object"); \
 	return -1; \
 }
@@ -687,13 +687,13 @@ DUMMY_FILL(dir);
 DUMMY_FILL(sdev);
 DUMMY_FILL(partition);
 
-#define DUMMY_LOOKUP(abbrev) \
-static int \
-abbrev ## _lookup(struct c2_conf_obj *parent, const struct c2_buf *name, \
-		  struct c2_conf_obj **out) \
-{ \
-	C2_IMPOSSIBLE("XXX"); \
-	return -1; \
+#define DUMMY_LOOKUP(abbrev)                             \
+static int abbrev ## _lookup(struct c2_conf_obj *parent, \
+			     const struct c2_buf *name,  \
+			     struct c2_conf_obj **out)   \
+{                                                        \
+	C2_IMPOSSIBLE("XXX");                            \
+	return -1;                                       \
 }
 
 DUMMY_LOOKUP(filesystem);
@@ -703,8 +703,8 @@ DUMMY_LOOKUP(nic);
 DUMMY_LOOKUP(sdev);
 DUMMY_LOOKUP(partition);
 
-static bool dir_match(const struct c2_conf_obj *cached,
-		      const struct confx_object *onwire)
+static bool
+dir_match(const struct c2_conf_obj *cached, const struct confx_object *onwire)
 {
 	C2_IMPOSSIBLE("XXX");
 	return false;
@@ -826,10 +826,7 @@ static int nic_fill(struct c2_conf_obj *__dest,
 	dest->ni_last_state = src->xi_last_state;
 
 	dest->ni_filename = buf_strdup(&src->xi_filename);
-	if (dest->ni_filename == NULL)
-		return -ENOMEM;
-
-	return 0;
+	return dest->ni_filename == NULL ? -ENOMEM : 0;
 }
 
 static int endpoints_populate(const char ***dest, const struct arr_buf *src)
diff --git a/conf/ut/prepar.c b/conf/ut/prepar.c
index 45788f0..acb1dd7 100644
--- a/conf/ut/prepar.c
+++ b/conf/ut/prepar.c
@@ -1,18 +1,16 @@
-#include <stdio.h>
-#include <string.h>
-
 #include "conf/preload.h"
 #include "conf/onwire.h"
 #include "lib/assert.h"
 #include "lib/errno.h"
 #include "lib/misc.h"
-
+#include <stdio.h>
+#include <string.h>
 
 int main(void)
 {
 	enum { KB = 1 << 10 };
-	char		    buf[32*KB] = {0};
-	size_t		    n;
+	char                buf[32*KB] = {0};
+	size_t              n;
 	struct confx_object conf[100];
 
 	n = fread(buf, 1, sizeof buf, stdin);
-- 
1.8.3.2

