From 4715680bef957767aca55e344148c28cea1fd119 Mon Sep 17 00:00:00 2001
From: "Valery V. Vorotyntsev" <valery_vorotyntsev@xyratex.com>
Date: Tue, 28 Aug 2012 21:30:57 +0300
Subject: [PATCH 304/370] conf: fix the precondition of c2_conf_reg_add()

RB: r/981/diff/3/?file=27990#file27990line56
---
 conf/reg.c | 2 +-
 conf/reg.h | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/conf/reg.c b/conf/reg.c
index db7e9f8..a1f79fd 100644
--- a/conf/reg.c
+++ b/conf/reg.c
@@ -53,7 +53,7 @@ void c2_conf_reg_init(struct c2_conf_reg *reg)
 
 void c2_conf_reg_add(struct c2_conf_reg *reg, struct c2_conf_obj *obj)
 {
-	C2_PRE(!c2_conf_reg_tlist_contains(&reg->r_objs, obj));
+	C2_PRE(!c2_conf_reg_tlink_is_in(obj));
 	c2_conf_reg_tlist_add(&reg->r_objs, obj);
 }
 
diff --git a/conf/reg.h b/conf/reg.h
index e062477..0c38487 100644
--- a/conf/reg.h
+++ b/conf/reg.h
@@ -95,7 +95,7 @@ void c2_conf_reg_fini(struct c2_conf_reg *reg);
 /**
  * Registers new configuration object.
  *
- * @pre  obj is not registered
+ * @pre  !c2_conf_reg_tlink_is_in(obj)
  */
 void c2_conf_reg_add(struct c2_conf_reg *reg, struct c2_conf_obj *obj);
 
-- 
1.8.3.2

