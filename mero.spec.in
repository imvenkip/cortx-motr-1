Name:    @PACKAGE@
Version: @PACKAGE_VERSION@
Release: 1
Summary: Mero filesystem and development libraries
Group: System Environment/Base
License: Xyratex
Source: %{name}-%{version}.tar.gz
BuildRoot: %{_tmppath}/%{name}-%{version}
Requires: CUnit = 2.1-2 libyaml galois db4 lustre-modules
BuildRequires: CUnit = 2.1-2 libyaml-devel galois-devel db4-devel automake autoconf libtool lustre-source gccxml gcc-c++ perl perl-XML-LibXML perl-List-MoreUtils

%description
Mero filesystem runtime environment and servers.

%package devel
Summary:	%{name} development package
Group:		Development/Libraries
Requires:	%{name} = %{version} libyaml-devel galois-devel db4-devel lustre-source

%description devel
Mero filesystem development environment.

%prep
%setup  -q -n %{name}-%{version}

%build
%configure --enable-rpm --program-prefix=%{?_program_prefix:%{_program_prefix}}
make

%install
rm -rf $RPM_BUILD_ROOT
export INSTALL_MOD_PATH=$RPM_BUILD_ROOT
DESTDIR="$RPM_BUILD_ROOT" make install

%files
%defattr(-,root,root)
%doc AUTHORS README NEWS ChangeLog COPYING INSTALL
%{_libdir}/libmero*.so*
/lib/modules/*
/usr/sbin/*
/usr/bin/*

%post
/sbin/depmod -a

%files devel
%defattr(-,root,root)
%doc AUTHORS README NEWS ChangeLog COPYING INSTALL doc
%{_includedir}/*
%{_libdir}/libmero*.a*
%{_libdir}/libmero*.la*
