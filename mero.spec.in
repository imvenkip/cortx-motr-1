Name:           @PACKAGE@
Version:        @PACKAGE_VERSION@
# TODO: add kernel version to release string like in lustre
Release:        1@GIT_REV_ID@%{?dist}
Summary:        Mero filesystem and development libraries
Group:          System Environment/Base
License:        Xyratex
Source:         %{name}-%{version}.tar.gz
BuildArch:      x86_64
ExcludeArch:    i686
# TODO: specify exact lustre-modules version for which we build
Requires:       lustre-modules db4 libyaml
BuildRequires:  automake autoconf libtool make gcc gcc-c++ gccxml glibc-headers kernel-devel db4-devel libyaml-devel libaio-devel perl perl-XML-LibXML perl-List-MoreUtils perl-File-Find-Rule perl-IO-All lustre-source

%description
Mero filesystem runtime environment and servers.

%prep
%setup -q

%build
%configure --disable-unit-tests
make %{?_smp_mflags}

%install
rm -rf %{buildroot}
make DESTDIR=%{buildroot} install
find %{buildroot} -name '*.la' -exec rm -f {} ';'

%files
%doc AUTHORS README NEWS ChangeLog COPYING
%{_bindir}/*
%{_sbindir}/*
%{_libdir}/*
/lib/modules/*
%exclude %{_includedir}

%post
/sbin/depmod -a

%postun
