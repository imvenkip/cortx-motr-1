C2T1FS_SRCDIR = @SRCDIR@/c2t1fs
KSUNRPC_SRCDIR = @SRCDIR@/net/ksunrpc
FOPDIR = @SRCDIR@/fop
STOBDIR = @SRCDIR@/stob/ut

subdirs := ../c2t1fs/ ../net/ksunrpc/ ../lib/linux_kernel/ \
           ../fop/linux_kernel/ ../addb/linux_kernel/ ../db/linux_kernel/ \
           ../sns/linux_kernel/ ../galois/linux_kernel/ ../pool/linux_kernel/ \
	   ../layout/linux_kernel/ ../stob/linux_kernel/ ../utils/linux_kernel/ \
	   ../rpc/linux_kernel/ ../xcode/linux_kernel/

obj-y += $(subdirs)

all:
	for s in $(subdirs) ;do $(MAKE) -C $$s prepare ;done
	$(MAKE) -C @LINUX_OBJ@ M=`pwd` modules

clean distclean:
	for s in $(subdirs) ;do $(MAKE) -C $$s clean ;done
	$(RM) Module.markers modules.order

install modules_install:
	for s in $(subdirs) ;do $(MAKE) -C $$s install ;done

uninstall:
	for s in $(subdirs) ;do $(MAKE) -C $$s uninstall ;done

dist distdir:
	for s in $(subdirs) ;do $(MAKE) -C $$s distdir ;done

