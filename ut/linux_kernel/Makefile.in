UT_SRCDIR = @top_srcdir@/ut/linux_kernel

GCOV_PROFILE := @K_ENABLE_COVERAGE@

obj-y		:= kut.o
shared_src	:= rpc.c
kernel_src	:=
kut-y		:= $(shared_src:.c=.o) $(kernel_src:.c=.o)
orig		:= $(shared_src:%=../%)

EXTRA_CFLAGS = -DHAVE_CONFIG_H -iquote @top_srcdir@ @C2_KCPPFLAGS@ @C2_KCFLAGS@ \
	       @KCFLAGS@

prepare:
	ln -fs $(orig) .

clean distclean:
	$(RM) $(shared_src) Module.markers Module.symvers modules.order
	$(MAKE) -C @LINUX_OBJ@ M=`pwd` clean

distdir:
	cp $(UT_SRCDIR)/Makefile.in $(UT_SRCDIR)/cob_kernel.c \
	    @top_builddir@/@PACKAGE@-@PACKAGE_VERSION@/ut/linux_kernel
