#!/usr/bin/env bash

SANDBOX_DIR=${SANDBOX_DIR:-/var/mero/sandbox.m0hagen}
M0_SRC_DIR=`readlink -f $0`
M0_SRC_DIR=${M0_SRC_DIR%/*/*}

. $M0_SRC_DIR/utils/functions # report_and_exit
[[ -d $SANDBOX_DIR ]] || mkdir -p $SANDBOX_DIR
cd $SANDBOX_DIR

$M0_SRC_DIR/utils/m0hagen --self-check
rc=$?

if [[ $rc -eq 0 && -d $SANDBOX_DIR ]]; then
    rm -r $SANDBOX_DIR
fi

report_and_exit m0hagen $rc
